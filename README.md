# E-commerce SQL Project

## Project Overview
This project analyzes sales data from an e-commerce platform to gain insights into customer behavior, sales performance, and product trends. Using SQL queries executed in a Python Jupyter Notebook, this analysis explores various dimensions of the data, from basic customer information to advanced sales metrics.

## Objectives
- To extract meaningful insights from e-commerce sales data.
- To analyze customer behavior and sales performance over time.
- To identify trends and correlations that can inform business decisions.

## Tools Used
- **Database**: MySQL (or any other SQL database)
- **Environment**: Python Jupyter Notebook
- **Libraries**: `pandas`, `numpy`, `matplotlib`, `seaborn` for data analysis and visualization

## Dataset
- **Source**: [Provide the source of your dataset, e.g., Kaggle, simulated dataset]
- **Structure**: The dataset contains tables such as `Orders`, `Customers`, `Products`, and `Categories`.

## Queries

### Basic Queries
1. **List all unique cities where customers are located.**
   ```sql
   SELECT DISTINCT city FROM Customers;
   ```

2. **Count the number of orders placed in 2017.**
   ```sql
   SELECT COUNT(*) FROM Orders WHERE YEAR(order_date) = 2017;
   ```

3. **Find the total sales per category.**
   ```sql
   SELECT category, SUM(sales_amount) AS total_sales
   FROM Products
   JOIN Orders ON Products.product_id = Orders.product_id
   GROUP BY category;
   ```

4. **Calculate the percentage of orders that were paid in installments.**
   ```sql
   SELECT (SUM(CASE WHEN payment_method = 'Installment' THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS percentage_installment
   FROM Orders;
   ```

5. **Count the number of customers from each state.**
   ```sql
   SELECT state, COUNT(*) AS customer_count
   FROM Customers
   GROUP BY state;
   ```

### Intermediate Queries
1. **Calculate the number of orders per month in 2018.**
   ```sql
   SELECT MONTH(order_date) AS month, COUNT(*) AS order_count
   FROM Orders
   WHERE YEAR(order_date) = 2018
   GROUP BY MONTH(order_date);
   ```

2. **Find the average number of products per order, grouped by customer city.**
   ```sql
   SELECT city, AVG(product_count) AS avg_products
   FROM (
       SELECT Orders.order_id, Customers.city, COUNT(order_details.product_id) AS product_count
       FROM Orders
       JOIN Customers ON Orders.customer_id = Customers.customer_id
       JOIN order_details ON Orders.order_id = order_details.order_id
       GROUP BY Orders.order_id
   ) AS order_summary
   GROUP BY city;
   ```

3. **Calculate the percentage of total revenue contributed by each product category.**
   ```sql
   SELECT category, (SUM(sales_amount) / (SELECT SUM(sales_amount) FROM Orders)) * 100 AS revenue_percentage
   FROM Products
   JOIN Orders ON Products.product_id = Orders.product_id
   GROUP BY category;
   ```

4. **Identify the correlation between product price and the number of times a product has been purchased.**
   ```sql
   SELECT price, COUNT(order_details.product_id) AS purchase_count
   FROM Products
   JOIN order_details ON Products.product_id = order_details.product_id
   GROUP BY price;
   ```

5. **Calculate the total revenue generated by each seller, and rank them by revenue.**
   ```sql
   SELECT seller_id, SUM(sales_amount) AS total_revenue
   FROM Orders
   GROUP BY seller_id
   ORDER BY total_revenue DESC;
   ```

### Advanced Queries
1. **Calculate the moving average of order values for each customer over their order history.**
   ```sql
   SELECT customer_id, order_date, 
          AVG(sales_amount) OVER (PARTITION BY customer_id ORDER BY order_date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_average
   FROM Orders;
   ```

2. **Calculate the cumulative sales per month for each year.**
   ```sql
   SELECT YEAR(order_date) AS year, MONTH(order_date) AS month,
          SUM(sales_amount) OVER (PARTITION BY YEAR(order_date) ORDER BY MONTH(order_date)) AS cumulative_sales
   FROM Orders;
   ```

3. **Calculate the year-over-year growth rate of total sales.**
   ```sql
   SELECT YEAR(order_date) AS year, 
          (SUM(sales_amount) - LAG(SUM(sales_amount)) OVER (ORDER BY YEAR(order_date))) / NULLIF(LAG(SUM(sales_amount)) OVER (ORDER BY YEAR(order_date)), 0) * 100 AS growth_rate
   FROM Orders
   GROUP BY YEAR(order_date);
   ```

4. **Calculate the retention rate of customers, defined as the percentage of customers who make another purchase within 6 months of their first purchase.**
   ```sql
   SELECT (COUNT(DISTINCT customer_id) - COUNT(DISTINCT CASE WHEN next_purchase_date <= DATE_ADD(first_purchase_date, INTERVAL 6 MONTH) THEN customer_id END)) / COUNT(DISTINCT customer_id) * 100 AS retention_rate
   FROM (
       SELECT customer_id, MIN(order_date) AS first_purchase_date, MIN(order_date) AS next_purchase_date
       FROM Orders
       GROUP BY customer_id
   ) AS purchase_summary;
   ```

5. **Identify the top 3 customers who spent the most money in each year.**
   ```sql
   SELECT year, customer_id, total_spent,
          ROW_NUMBER() OVER (PARTITION BY year ORDER BY total_spent DESC) AS rank
   FROM (
       SELECT YEAR(order_date) AS year, customer_id, SUM(sales_amount) AS total_spent
       FROM Orders
       GROUP BY YEAR(order_date), customer_id
   ) AS yearly_spending
   WHERE rank <= 3;
   ```

## Conclusion
This project showcases the ability to perform in-depth analysis on e-commerce sales data using SQL queries. The insights gained from this analysis can assist in making data-driven decisions to improve sales strategies, customer engagement, and overall business performance.
